tinymce.PluginManager.add("filemanager",function(b){tinymce.activeEditor.settings.file_browser_callback=c;function a(d){if(b.settings.external_filemanager_path.toLowerCase().indexOf(d.origin.toLowerCase())===0){if(d.data.sender==="filemanager"){tinymce.activeEditor.windowManager.getParams().setUrl(d.data.url);tinymce.activeEditor.windowManager.close();if(window.removeEventListener){window.removeEventListener("message",a,false)}else{window.detachEvent("onmessage",a)}}}}function c(f,m,j,i){urltype=2;if(j=="image"){urltype=1}if(j=="media"){urltype=3}var l="RESPONSIVE FileManager";if(typeof b.settings.filemanager_title!=="undefined"&&b.settings.filemanager_title){l=b.settings.filemanager_title}var h="key";if(typeof b.settings.filemanager_access_key!=="undefined"&&b.settings.filemanager_access_key){h=b.settings.filemanager_access_key}var k="";if(typeof b.settings.filemanager_sort_by!=="undefined"&&b.settings.filemanager_sort_by){k="&sort_by="+b.settings.filemanager_sort_by}var g="false";if(typeof b.settings.filemanager_descending!=="undefined"&&b.settings.filemanager_descending){g=b.settings.filemanager_descending}var e="";if(typeof b.settings.filemanager_subfolder!=="undefined"&&b.settings.filemanager_subfolder){e="&fldr="+b.settings.filemanager_subfolder}var d="";if(typeof b.settings.filemanager_crossdomain!=="undefined"&&b.settings.filemanager_crossdomain){d="&crossdomain=1";if(window.addEventListener){window.addEventListener("message",a,false)}else{window.attachEvent("onmessage",a)}}tinymce.activeEditor.windowManager.open({title:l,file:b.settings.external_filemanager_path+"dialog.php?type="+urltype+"&descending="+g+k+e+d+"&lang="+b.settings.language+"&akey="+h,width:860,height:570,resizable:true,maximizable:true,inline:1},{setUrl:function(o){var p=i.document.getElementById(f);p.value=b.convertURL(o);if("fireEvent" in p){p.fireEvent("onchange")}else{var n=document.createEvent("HTMLEvents");n.initEvent("change",false,true);p.dispatchEvent(n)}}})}return false});